
# 为什么需要主从

1. 高可用：<font color="#de7802">数据备份</font>，防止单点故障导致数据丢失；<font color="#de7802">故障转移</font>，防止单点故障导致上有服务不可用；
2. 高性能：防止高流量场景导致的数据库压力过大（负载过大、IO瓶颈、读写并发），通过多个从库分摊流量压力；

# 主从复制过程
https://www.bilibili.com/video/BV1FH4y1K7rn/?spm_id_from=333.788&vd_source=ce67cf212f4a949cf75348b5404c5e27

![[../../images/04-Database-MySQL-MasterSlave.png]]

准备工作：
1. 主库需要开启`binlog`，记录着所有对数据的修改：插入、更新、删除；
2. 主库、从库都需要分配唯一的MySQL服务器id（1 ~ 2<sup>32</sup>-1）；
3. 从库的配置文件中需要指定主库的ip、端口、用户密码等；
4. 同步模式：异步复制、半同步复制；
	- 异步复制：写操作完成后立即提交事务返回，无论是否同步给从库；
	- 半同步复制：写操作完成后，最少1个从库完成了同步，再提交事务；（5.1之后插件支持）
3个核心线程：
- Dump thread：主节点线程；负责将数据变更`binlog`发送给从节点；
- IO thread：从节点线程；接收`binlog`，并写入到`relay log`中继日志中；
- SQL thread：从节点线程；重放`binlog`完成数据写入；

# 是拉还是推？？


# 主从问题：复制延迟

