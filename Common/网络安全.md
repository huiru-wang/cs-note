- [CSRF](#csrf)
  - [CSRF 防御](#csrf-防御)
- [XSS](#xss)
  - [反射型XSS](#反射型xss)
  - [存储型XSS](#存储型xss)
  - [XSS防御](#xss防御)
- [SQL注入](#sql注入)

# CSRF
例如：
1、假设你已经登录了你的银行账户并保持着会话，同时你又在浏览某个恶意网站；(或者不小心通过广告点开恶意网站)
2、恶意网站携带恶意脚本，执行特定请求，就可能会在你不知情的情况下向你的银行账户发送转账请求，此请求自动会携带站点下的Cookie，**利用你已经登录的身份**转移你的资金。如果银行没有实施CSRF防护措施，那么这个攻击就可以成功

## CSRF 防御
本质：**后端服务识别出请求的来源，是否是第三方站点发起的；并且不可以Cookie作为依据**

1、验证来源站点：Http请求头：referer/Origin

2、隐藏域Token验证机制 + httponly

恶意站点直接发送特定请求，无法获取对应站点的Token；

每次请求资源时，服务端发放Token给客户端(同时保存在服务端)，提交表单等操作消耗Token；防止第三方站点直接提交表单；

- 需要配合httponly是为了防止Token被第三方恶意脚本获取；
- Token不要放在Coookie中，恶意链接会直接携带站点下的Cookie，从而携带Token，不安全；
- 可以存放在表单、URL参数，都可以，其他站点是获取不到的；

3、限制跨域CORS

服务端设置响应头：Access-Control-Allow-Origin声明可以跨域访问的域名，不允许的则不能从第三方站点跳转时携带资源，如Cookie；

4、敏感操作，二次验证

修改密码、转账等操作，需要验证手机、邮箱等；
# XSS
XSS：跨站脚本攻击；攻击者通过在网页中注入恶意脚本，当其他用户访问页面，代码触发执行，来获取用户的敏感信息或执行恶意操作；
- Cross-Site Scripting：简写CSS于样式文件名重复，简写为XSS；
- XSS攻击需要将脚本通过某种方式**注入到服务端，再由其他用户访问时，执行恶意脚本来实现的**；
- XSS通常出现在用户可自定义、提交的功能中，并且会被存储可由其他用户访问的数据中；
- web端通常用于登录Cookie，有了Cookie基本上可以直接登录其他用户的账号；

## 反射型XSS
注入流程：

1、直接通过服务器功能：比如评论功能，将恶意脚本到服务器、数据库中；

2、其他用户访问到带有恶意脚本的页面，脚本 自动/诱导用户点击 执行后，窃取用户信息；

## 存储型XSS


## XSS防御
1、过滤出脚本
一般使用正则匹配各种XSS攻击脚本模式来过滤：如<script></script>）

2、特殊字符转义处理
将特殊字符转移后，变成普通字符，而非代码；
<、>、' 👉 \<、\>、\'

3、

# SQL注入